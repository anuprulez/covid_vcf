<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
   
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-axis.v1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.8.0-alpha.1/d3-tip.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js"></script>

    	
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap4.min.css">

    <style type="text/css">



    </style>
  </head>
  <body>
  
  <div style="margin:1%">
  
  <h3>COVID-19 Mutations analysis</h3>
  
  Select analysis:
  
  <select id="select_analysis" name="select_analysis" onchange="get_analysis(this)">
    <option value ="-1" selected>None</option>
    
    <!-- All -->
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/all/clusters_of_mutations_with_singletons.csv">Boston all clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/all/merged_clusters_of_mutations.csv">Boston all merged clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/all/only_deletions.csv">Boston all deletions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/all/only_insertions.csv">Boston all insertions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/all/only_substitutions.csv">Boston all substitutions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/all/clusters_of_co-occurring_samples.csv">Boston all co-occurring mutations</option>
    
    <!-- AF -->
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/af/clusters_of_mutations_with_singletons.csv">Boston AF(< 0.8) clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/af/merged_clusters_of_mutations.csv">Boston AF(< 0.8) merged clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/af/only_deletions.csv">Boston AF(< 0.8) deletions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/af/only_insertions.csv">Boston AF(< 0.8) insertions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/af/only_substitutions.csv">Boston AF(< 0.8) substitutions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/af/clusters_of_co-occurring_samples.csv">Boston AF(< 0.8) co-occurring mutations</option>
    
    <!-- Clades -->
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/clades/clusters_of_mutations_with_singletons.csv">Boston clades ex clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/clades/merged_clusters_of_mutations.csv">Boston clades ex merged clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/clades/only_deletions.csv">Boston clades ex deletions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/clades/only_insertions.csv">Boston clades ex insertions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/clades/only_substitutions.csv">Boston clades ex substitutions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/clades/clusters_of_co-occurring_samples.csv">Boston clades ex co-occurring mutations</option>
    
    <!-- AF clades -->
    
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/af_clades/clusters_of_mutations_with_singletons.csv">Boston AF(< 0.8) & clades ex clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/af_clades/merged_clusters_of_mutations.csv">Boston AF(< 0.8) & clades ex merged clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/af_clades/only_deletions.csv">Boston AF(< 0.8) & clades ex deletions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/af_clades/only_insertions.csv">Boston AF(< 0.8) & clades ex insertions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/af_clades/only_substitutions.csv">Boston AF(< 0.8) & clades ex substitutions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Boston/af_clades/clusters_of_co-occurring_samples.csv">Boston AF(< 0.8) & clades ex co-occurring mutations</option>
    
    
    
    <!-- Pre-COGUK -->
    
    <!-- All -->
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/all/clusters_of_mutations_with_singletons.csv">Pre-COG-UK all clusters</option>
        
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/all/merged_clusters_of_mutations.csv">Pre-COG-UK all merged clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/all/only_deletions.csv">Pre-COG-UK all deletions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/all/only_insertions.csv">Pre-COG-UK all insertions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/all/only_substitutions.csv">Pre-COG-UK all substitutions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/all/clusters_of_co-occurring_samples.csv">Pre-COG-UK all co-occurring mutations</option>
    
    <!-- AF -->
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/af/clusters_of_mutations_with_singletons.csv">Pre-COG-UK AF(< 0.8) clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/af/merged_clusters_of_mutations.csv">Pre-COG-UK AF(< 0.8) merged clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/af/only_deletions.csv">Pre-COG-UK AF(< 0.8) deletions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/af/only_insertions.csv">Pre-COG-UK AF(< 0.8) insertions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/af/only_substitutions.csv">Pre-COG-UK AF(< 0.8) substitutions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/af/clusters_of_co-occurring_samples.csv">Pre-COG-UK AF(< 0.8) co-occurring mutations</option>
    
    <!-- Clades -->
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/clades/clusters_of_mutations_with_singletons.csv">Pre-COG-UK clades ex clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/clades/merged_clusters_of_mutations.csv">Pre-COG-UK clades ex merged clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/clades/only_deletions.csv">Pre-COG-UK clades ex deletions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/clades/only_insertions.csv">Pre-COG-UK clades ex insertions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/clades/only_substitutions.csv">Pre-COG-UK clades ex substitutions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/clades/clusters_of_co-occurring_samples.csv">Pre-COG-UK clades ex co-occurring mutations</option>
    
    <!-- AF clades -->
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/af_clades/clusters_of_mutations_with_singletons.csv">Pre-COG-UK AF(< 0.8) & clades ex clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/af_clades/merged_clusters_of_mutations.csv">Pre-COG-UK AF(< 0.8) & clades ex merged clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/af_clades/only_deletions.csv">Pre-COG-UK AF(< 0.8) & clades ex deletions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/af_clades/only_insertions.csv">Pre-COG-UK AF(< 0.8) & clades ex insertions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/af_clades/only_substitutions.csv">Pre-COG-UK AF(< 0.8) & clades ex substitutions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Pre-COG-UK/af_clades/clusters_of_co-occurring_samples.csv">Pre-COG-UK AF(< 0.8) & clades ex co-occurring mutations</option>
    
    
    <!-- Post-COGUK -->
    
    <!-- All -->
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/all/clusters_of_mutations_with_singletons.csv">Post-COG-UK all clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/all/merged_clusters_of_mutations.csv">Post-COG-UK all merged clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/all/only_deletions.csv">Post-COG-UK all deletions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/all/only_insertions.csv">Post-COG-UK all insertions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/all/only_substitutions.csv">Post-COG-UK all substitutions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/all/clusters_of_co-occurring_samples.csv">Post-COG-UK all co-occurring mutations</option>
    
    <!-- AF -->
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/af/clusters_of_mutations_with_singletons.csv">Post-COG-UK AF(< 0.8) clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/af/merged_clusters_of_mutations.csv">Post-COG-UK AF(< 0.8) merged clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/af/only_deletions.csv">Post-COG-UK AF(< 0.8) deletions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/af/only_insertions.csv">Post-COG-UK AF(< 0.8) insertions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/af/only_substitutions.csv">Post-COG-UK AF(< 0.8) substitutions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/af/clusters_of_co-occurring_samples.csv">Post-COG-UK AF(< 0.8) co-occurring mutations</option>
    
    <!-- Clades -->
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/clades/clusters_of_mutations_with_singletons.csv">Post-COG-UK clades ex clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/clades/merged_clusters_of_mutations.csv">Post-COG-UK clades ex merged clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/clades/only_deletions.csv">Post-COG-UK clades ex deletions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/clades/only_insertions.csv">Post-COG-UK clades ex insertions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/clades/only_substitutions.csv">Post-COG-UK clades ex substitutions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/clades/clusters_of_co-occurring_samples.csv">Post-COG-UK clades ex co-occurring mutations</option>
    
    <!-- AF clades -->
    	
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/af_clades/clusters_of_mutations_with_singletons.csv">Post-COG-UK AF(< 0.8) & clades ex clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/af_clades/merged_clusters_of_mutations.csv">Post-COG-UK AF(< 0.8) & clades ex merged clusters</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/af_clades/only_deletions.csv">Post-COG-UK AF(< 0.8) & clades ex deletions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/af_clades/only_insertions.csv">Post-COG-UK AF(< 0.8) & clades ex insertions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/af_clades/only_substitutions.csv">Post-COG-UK AF(< 0.8) & clades ex substitutions</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Post-COG-UK/af_clades/clusters_of_co-occurring_samples.csv">Post-COG-UK AF(< 0.8) & clades ex co-occurring mutations</option>
    
    <!-- Common mutations for Boston, Pre and Post-COGUK datasets -->
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Common/all/common_pos_mc_pre_post_cog_uk.csv">Common POS (Pre and Post-COG-UK)</option>
    
    <option value ="https://raw.githubusercontent.com/anuprulez/covid_vcf/sklearn/data/outputs/Common/all/common_pos_mc_boston_pre_post_cog_uk.csv">Common POS (Boston, Pre and Post-COG-UK)</option>
    
    
    
  </select>
  
  <div id="filters_ele" style="display:none">
  
  Filters:
 
  <select id="selectbox_operator">
    <option value ="-1">--Select operator--</option>
    <option value ="equal">Equal to</option>
    <option value ="less_than">Less than</option>
    <option value ="less_than_equal">Less than equal to</option>
    <option value ="greater_than">Greater than</option>
    <option value ="greater_than_equal">Greater than equal to</option>
    
    
  </select>
  
  <input id="txtbxFilter" type="text">
  
  <input id="btn_minAF" type="button" value="Filter by MinAF" onclick="filterBy(this, 'MinAF')">
  <input id="btn_maxAF" type="button" value="Filter by MaxAF" onclick="filterBy(this, 'MaxAF')">
  <input id="btn_AF" type="button" value="Filter by AF" onclick="filterBy(this, 'AF')">
  <input id="btn_POS" type="button" value="Filter by POS" onclick="filterBy(this, 'POS')">
  <input id="btn_REF" type="button" value="Filter by REF" onclick="filterBy(this, 'REF')">
  <input id="btn_ALT" type="button" value="Filter by ALT" onclick="filterBy(this, 'ALT')">

  <div>
  
  Number of rows: <label id="num_rows">0</label>
  
  </div>
  
  </div>
  
  <div>
  
  <input id="reset" type="button" onclick="reset(this)" value="Reset">
  
  </div>

 <table id="specific_run_table" class="table table-striped table-bordered" style="width:95%; margin-top:1%">

 </table>
    
        
<script type="text/javascript">
    
    global_data = [];
    global_columns = [];
    
    function clearTable() {
        $('#specific_run_table').empty();
    }
    
    function reset(e){
        clearTable();
        $("#selectbox_operator").val("-1");
        $("#txtbxFilter").val("");
        $("#select_analysis").val("-1");
        $("#num_rows").text("0");
        $("#filters_ele").hide();
    }

    function filterBy(e, colName) {
        ope = $("#selectbox_operator").val();
        txtVal = $("#txtbxFilter").val();
        let matchOpe = "";
        if (ope === "-1") {
            $("#txtbxFilter").val("-1");
            return;
        }
        
        if(ope === "equal") {
            matchOpe = "==";
        }
        else if (ope === "less_than") {
            matchOpe = "<";
        }
        else if(ope === "less_than_equal") {
            matchOpe = "<=";
        }
        else if(ope === "greater_than") {
            matchOpe = ">";
        }
        else if(ope === "greater_than_equal") {
            matchOpe = ">=";
        }
        
        set_table(global_data, global_columns, matchOpe, txtVal, colName);
    }

    function set_table(data, cols, operator, value, col) {
        filteredData = [];
        for(i=0; i< data.length; i++) {
            let colVal = data[i][col];
            if (col === "POS") {
                colVal = parseInt(colVal);
                value = parseInt(value);
            }
            if (operator == "<") {
                if (colVal < value) {
                    filteredData.push(data[i])
                }
            }
            else if (operator == "<=") {
                if (colVal <= value) {
                    filteredData.push(data[i])
                }
            }
            else if (operator == "==") {
                if (colVal == value) {
                    filteredData.push(data[i])
                }
            }
            else if (operator == ">") {
                if (colVal > value) {
                    filteredData.push(data[i])
                }
            }
            else if (operator == ">=") {
                if (colVal >= value) {
                    filteredData.push(data[i])
                }
            }
        }
        crateTable(filteredData, cols);
        $("#num_rows").text(filteredData.length);
    }

    function get_analysis(e) {
      var path = e.value;
      if (path !== "-1") {
          $("#filters_ele").show();
          d3.csv(path)
              .get(function(data) {
                  columns = data.columns;
                  idx = columns.indexOf("SampleNames")
                  if (idx > -1) {
                      columns.splice(idx, 1);
                  }
                  global_data = data;
                  global_columns = columns;
                  crateTable(data, columns);
                  $("#num_rows").text(data.length);
            });
      }
      else {
          reset();
      }
      
    }

let crateTable = function (data, columns) {
    clearTable();
    var table = d3.select('#specific_run_table')
      var thead = table.append('thead')
      var tbody = table.append('tbody')


      thead.append('tr')
        .selectAll('th')
          .data(columns)
          .enter()
        .append('th')
          .text(function (d) { return d })

      var rows = tbody.selectAll('tr')
          .data(data)
          .enter()
        .append('tr')

      var cells = rows.selectAll('td')
          .data(function(row) {
              return columns.map(function (column) {
                  return { column: column, value: row[column] }
            })
        })
        .enter()
      .append('td')
        .text(function (d) { return d.value })
    return table;
  }
	 
</script>
  </div>
  </body>
</html>
